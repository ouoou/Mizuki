---
title: Leetcode-å‰ç¼€å’Œç±»é¢˜å‹
published: 2025-09-02
updated: 2025-09-02
description: ""
image: ""
tags:
  - Leetcode
  - å‰ç¼€å’Œ
category: Leetcode
draft: false
---
# Leetcode 525
## é¢˜ç›®å›é¡¾
ç»™å®šä¸€ä¸ªäºŒè¿›åˆ¶æ•°ç»„ nums , æ‰¾åˆ°å«æœ‰ç›¸åŒæ•°é‡çš„ 0 å’Œ 1 çš„æœ€é•¿è¿ç»­å­æ•°ç»„ï¼Œå¹¶è¿”å›è¯¥å­æ•°ç»„çš„é•¿åº¦ã€‚
## é¢˜æ„ç†è§£

ç»™å®šä¸€ä¸ªäºŒè¿›åˆ¶æ•°ç»„ï¼ˆåªåŒ…å« 0 å’Œ 1ï¼‰ã€‚

éœ€è¦æ‰¾å‡ºä¸€ä¸ªæœ€é•¿çš„è¿ç»­å­æ•°ç»„ï¼Œå…¶ä¸­ 0 å’Œ 1 çš„æ•°é‡ç›¸ç­‰ã€‚

è¿”å›è¿™ä¸ªå­æ•°ç»„çš„é•¿åº¦

---
## è½¬åŒ–æ–¹æ³•

æŠŠæ•°ç»„ä¸­çš„ 0 æ›¿æ¢ä¸º -1ï¼Œä¿ç•™ 1 ä¸º 1ã€‚

è¿™æ ·ï¼Œ0 å’Œ 1 çš„æ•°é‡ç›¸ç­‰ â‡” å­æ•°ç»„çš„å…ƒç´ å’Œä¸º 0ã€‚

ä¾‹å¦‚ï¼š
nums = [0,1,0]
è½¬æ¢åï¼š[-1,1,-1]
å…¶ä¸­å­æ•°ç»„ [1,-1] å’Œä¸º 0ï¼Œè¯´æ˜ 0 å’Œ 1 ä¸ªæ•°ç›¸ç­‰ã€‚

æ±‚å‰ç¼€å’Œï¼š

å¦‚æœä¸¤ä¸ªå‰ç¼€å’Œç›¸åŒï¼Œè¯´æ˜è¿™ä¸¤ç‚¹ä¹‹é—´çš„å­æ•°ç»„å’Œä¸º 0ã€‚
æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ° ç›¸åŒå‰ç¼€å’Œä¹‹é—´çš„æœ€å¤§è·ç¦»ã€‚

---

## å…¬å¼æ¨å¯¼
å¦‚æœæœ‰ä¸¤ä¸ªä½ç½® i å’Œ j (i < j)ï¼Œä¸” `sum[i] == sum[j]`ï¼Œè¯´æ˜ï¼š
```bash
nums[i+1] + nums[i+2] + ... + nums[j] = sum[j] - sum[i] = 0
```
æ¢å¥è¯è¯´ï¼Œè¿™ä¸­é—´çš„**å­æ•°ç»„å’Œä¸º 0ã€‚**



### ä¾‹å­

```
nums = [0,1,1,1,1,1,0,0,0]
```

å…ˆåšè½¬åŒ–ï¼ˆ0 â†’ -1ï¼Œ1 â†’ +1ï¼‰ï¼š

```
[-1, +1, +1, +1, +1, +1, -1, -1, -1]
```

---

#### 1. è®¡ç®—å‰ç¼€å’Œ

ä»ç´¢å¼• `-1` å¼€å§‹ï¼ˆåˆå§‹ sum=0ï¼‰ï¼š

| i  | nums\[i] | è½¬æ¢å€¼ | å‰ç¼€å’Œ sum |
| -- | -------- | --- | ------- |
| -1 | -        | -   | 0       |
| 0  | 0        | -1  | -1      |
| 1  | 1        | +1  | 0       |
| 2  | 1        | +1  | 1       |
| 3  | 1        | +1  | 2       |
| 4  | 1        | +1  | 3       |
| 5  | 1        | +1  | 4       |
| 6  | 0        | -1  | 3       |
| 7  | 0        | -1  | 2       |
| 8  | 0        | -1  | 1       |

---

#### 2. ç”¨æ•°è½´ç›´è§‚è¡¨ç¤ºï¼ˆsum æ›²çº¿ï¼‰

ç”»æˆé«˜åº¦å˜åŒ–ï¼ˆsum æ˜¯çºµè½´ï¼Œi æ˜¯æ¨ªè½´ï¼‰ï¼š

```
i:   -1   0   1   2   3   4   5   6   7   8
sum:  0  -1   0   1   2   3   4   3   2   1
```

---

## 3. ä¸ºä»€ä¹ˆç›¸åŒ sum ä»£è¡¨å’Œä¸º 0 çš„å­æ•°ç»„ï¼Ÿ

æ¯”å¦‚ï¼š

* sum åœ¨ i=2 æ—¶ä¸º 1
* sum åœ¨ i=8 æ—¶ä¹Ÿä¸º 1

ğŸ‘‰ è¯´æ˜åŒºé—´ `(2,8]` çš„å’Œä¸º 0ï¼Œä¹Ÿå°±æ˜¯å­æ•°ç»„ **\[1,1,1,0,0,0]**ã€‚

å†çœ‹ï¼š

* sum åœ¨ i=3 æ—¶ä¸º 2
* sum åœ¨ i=7 æ—¶ä¹Ÿä¸º 2

ğŸ‘‰ åŒºé—´ `(3,7]` å’Œä¸º 0ï¼Œä¹Ÿå°±æ˜¯å­æ•°ç»„ **\[1,1,0,0]**ã€‚

å†çœ‹ï¼š

* sum åœ¨ i=-1 æ—¶ä¸º 0
* sum åœ¨ i=1 æ—¶ä¸º 0

ğŸ‘‰ åŒºé—´ `( -1,1 ]` å’Œä¸º 0ï¼Œä¹Ÿå°±æ˜¯å­æ•°ç»„ **\[0,1]**ã€‚

---

## 4. æ‰¾åˆ°æœ€é•¿å­æ•°ç»„

åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæœ€é•¿çš„æ˜¯ï¼š

* sum=1 åœ¨ i=2 å’Œ i=8 ä¸¤æ¬¡å‡ºç°
* åŒºé—´é•¿åº¦ = 8 - 2 = 6
* å­æ•°ç»„æ˜¯ **\[1,1,1,0,0,0]**

---

âœ… ç›´è§‚è§£é‡Šå°±æ˜¯ï¼š
åœ¨å‰ç¼€å’Œæ›²çº¿ä¸Šï¼Œ**â€œç›¸åŒé«˜åº¦çš„ä¸¤ä¸ªç‚¹ä¹‹é—´â€** çš„åŒºé—´ï¼Œè¡¨ç¤ºè¿™æ®µå­æ•°ç»„çš„å’Œä¸º 0 â‡’ 0 å’Œ 1 ä¸ªæ•°ç›¸ç­‰ã€‚

---
![img.png](guide/leetcode525.png)

## javaè§£æ³•
```java
class Solution {
    public int findMaxLength(int[] nums) {
        //  [0,1,0]
        // 0 -1 0 -1
        Map<Integer, Integer> map = new HashMap<>();
        map.put(0, -1);
        int max = 0;
        int sum = 0;
        for (int i = 0; i < nums.length; i++) {
            sum += nums[i] == 1 ? 1 : -1;
            if (map.containsKey(sum)) {
                max = Math.max(max, i - map.get(sum));
            } else {
                map.put(sum, i);
            }
        }
        return max;
    }
}
```

# Leetcode 523


---

## é¢˜ç›®å›é¡¾

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªæ•´æ•° `k`ã€‚
è¯·åˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸€ä¸ª **é•¿åº¦è‡³å°‘ä¸º 2** çš„è¿ç»­å­æ•°ç»„ï¼Œä½¿å¾—è¯¥å­æ•°ç»„çš„å’Œæ˜¯ `k` çš„å€æ•°ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼š
æ‰¾åˆ° `sum(nums[i..j]) % k == 0`ï¼Œå¹¶ä¸” `j - i >= 1`ã€‚

---

## æ€è·¯è§£æ

### **å‰ç¼€å’Œ + å–æ¨¡ä¼˜åŒ–**

è®¾å‰ç¼€å’Œä¸ºï¼š

```
prefix[i] = nums[0] + nums[1] + ... + nums[i]
```

å¦‚æœå­˜åœ¨ä¸¤ä¸ªä¸‹æ ‡ `i < j`ï¼Œæ»¡è¶³ï¼š

```
(prefix[j] - prefix[i]) % k == 0
```

ç­‰ä»·äºï¼š

```
prefix[j] % k == prefix[i] % k
```

**å…³é”® insightï¼š**

* å¦‚æœä¸¤ä¸ªå‰ç¼€å’Œé™¤ä»¥ `k` çš„ä½™æ•°ç›¸åŒï¼Œåˆ™å®ƒä»¬ä¹‹é—´çš„å­æ•°ç»„å’Œå°±æ˜¯ `k` çš„å€æ•°ã€‚

---

## å…¬å¼æ¨å¯¼

å¦‚æœæœ‰ä¸¤ä¸ªå‰ç¼€å’Œï¼š

```
prefix[j] å’Œ prefix[i]   (i < j)
```

å¹¶ä¸”æ»¡è¶³ï¼š

```
prefix[j] % k == prefix[i] % k
```

é‚£ä¹ˆä¸€å®šæœ‰ï¼š

```
(prefix[j] - prefix[i]) % k == 0
```

ä¹Ÿå°±æ˜¯ `nums[i+1..j]` çš„å’Œæ˜¯ `k` çš„å€æ•°ã€‚

---

### ä¸¾ä¸ªä¾‹å­

å‡è®¾æ•°ç»„ï¼š

```
nums = [23, 2, 4, 6, 7], k = 6
```

#### æ­¥éª¤ 1ï¼šè®¡ç®—å‰ç¼€å’Œ

```
prefix[0] = 23
prefix[1] = 23 + 2 = 25
prefix[2] = 25 + 4 = 29
prefix[3] = 29 + 6 = 35
prefix[4] = 35 + 7 = 42
```

#### æ­¥éª¤ 2ï¼šå–æ¨¡

```
prefix[0] % 6 = 23 % 6 = 5
prefix[1] % 6 = 25 % 6 = 1
prefix[2] % 6 = 29 % 6 = 5
prefix[3] % 6 = 35 % 6 = 5
prefix[4] % 6 = 42 % 6 = 0
```

#### æ­¥éª¤ 3ï¼šæ‰¾ç›¸åŒä½™æ•°

* `prefix[0] % 6 = 5`
* `prefix[2] % 6 = 5`

è¯´æ˜ `prefix[2] - prefix[0]` æ˜¯ 6 çš„å€æ•°ï¼š

```
29 - 23 = 6
```

è€Œè¿™æ­£å¥½å¯¹åº”å­æ•°ç»„ `[2, 4]`ï¼Œå®ƒçš„å’Œæ˜¯ 6ï¼Œç¡®å®æ˜¯ 6 çš„å€æ•°ã€‚

å†çœ‹ï¼š

* `prefix[3] % 6 = 5`
* `prefix[0] % 6 = 5`

```
35 - 23 = 12
```

å¯¹åº”å­æ•°ç»„ `[2, 4, 6]`ï¼Œå’Œä¸º 12ï¼Œä¹Ÿæ˜¯ 6 çš„å€æ•°ã€‚

---

### ä¸ºä»€ä¹ˆæˆç«‹ï¼ˆæ•°å­¦è§£é‡Šï¼‰

1. å‡è®¾

   ```
   prefix[j] % k = r
   prefix[i] % k = r
   ```

   ï¼ˆå®ƒä»¬ä½™æ•°ç›¸åŒï¼Œéƒ½æ˜¯ `r`ï¼‰

2. æ ¹æ®æ¨¡çš„å®šä¹‰

   ```
   prefix[j] = a * k + r
   prefix[i] = b * k + r
   ```

   ï¼ˆaã€b æ˜¯æ•´æ•°ï¼‰

3. ä¸¤è€…ç›¸å‡ï¼š

   ```
   prefix[j] - prefix[i] = (a - b) * k
   ```

   ä¸€å®šæ˜¯ k çš„å€æ•° âœ…

---

## javaè§£æ³•

```java
class Solution {
    public boolean checkSubarraySum(int[] nums, int k) {
        Map<Integer, Integer> map = new HashMap<>();
        map.put(0,-1);

        int prefix = 0;
        for (int i = 0; i < nums.length; i++) {
            prefix += nums[i];
            int mod = prefix % k;
            if (map.containsKey(mod)) {
                if (i - map.get(mod) >= 2) {
                    return true;
                }
            } else {
                map.put(mod, i);
            }
        }
        return false;
    }
}
```

# Leetcode 560

## é¢˜ç›®ç®€è¿°

ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªæ•´æ•° `k`ï¼Œè¦æ±‚è®¡ç®—ï¼š**è¿ç»­å­æ•°ç»„çš„å’Œç­‰äº `k` çš„ä¸ªæ•°**ã€‚

---

## æ€è·¯åˆ†æ

### å‰ç¼€å’Œ + å“ˆå¸Œè¡¨ï¼ˆO(n)ï¼‰

æ ¸å¿ƒæ€æƒ³ï¼š

* å®šä¹‰ `prefixSum[i]` è¡¨ç¤ºæ•°ç»„å‰ `i` ä¸ªå…ƒç´ çš„å’Œã€‚
* ä»»æ„å­æ•°ç»„å’Œ `nums[i..j] = prefixSum[j] - prefixSum[i-1]`ã€‚
* å¦‚æœæŸä¸€æ®µå‰ç¼€å’Œä¸º `prefixSum[j]`ï¼Œæˆ‘ä»¬æƒ³è¦æ‰¾ä¸€æ®µå’Œä¸º `k` çš„å­æ•°ç»„ï¼Œé‚£ä¹ˆéœ€è¦ï¼š

  ```
  prefixSum[j] - prefixSum[i-1] = k
  â†’ prefixSum[i-1] = prefixSum[j] - k
  ```
* ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦ä¹‹å‰å‡ºç°è¿‡ `prefixSum[j] - k`ï¼Œé‚£ä¹ˆå°±å­˜åœ¨ä¸€ä¸ªå­æ•°ç»„çš„å’Œä¸º `k`ã€‚


## ä¾‹å­è§£æ
ç”¨ä¸€ä¸ªå…·ä½“ä¾‹å­ `[1, 2, 3]`ï¼Œ`k = 3`ï¼Œç”»ä¸€å¼  **å‰ç¼€å’Œ + å“ˆå¸Œè¡¨å˜åŒ–è¡¨** æ¥ç›´è§‚å±•ç¤ºæ•´ä¸ªè¿‡ç¨‹ã€‚

| i (ç´¢å¼•) | num\[i] | å½“å‰å‰ç¼€å’Œ sum | sum - k | map çŠ¶æ€ (å‰ç¼€å’Œ -> æ¬¡æ•°)   | count |
| ------ | ------- | --------- | ------- | -------------------- | ----- |
| -      | -       | 0         | -       | {0:1}                | 0     |
| 0      | 1       | 1         | -2      | {0:1, 1:1}           | 0     |
| 1      | 2       | 3         | 0       | {0:1, 1:1, 3:1}      | 1     |
| 2      | 3       | 6         | 3       | {0:1, 1:1, 3:1, 6:1} | 2     |

**è§£é‡Šï¼š**

1. åˆå§‹æ—¶ï¼Œmapé‡Œæœ‰ `{0:1}` è¡¨ç¤ºå‰ç¼€å’Œä¸º0å‡ºç°è¿‡ä¸€æ¬¡ï¼ˆä¿è¯ä»æ•°ç»„å¼€å¤´å°±èƒ½å½¢æˆå­æ•°ç»„ï¼‰ã€‚
2. éå†åˆ° `i=0`ï¼Œsum=1ï¼Œmapé‡Œæ²¡æœ‰ `1-3=-2`ï¼Œæ‰€ä»¥ count ä¸å˜ï¼Œæ›´æ–° map ä¸º `{0:1, 1:1}`ã€‚
3. éå†åˆ° `i=1`ï¼Œsum=3ï¼Œmapé‡Œæœ‰ `3-3=0`ï¼Œè¯´æ˜æœ‰ä¸€ä¸ªå­æ•°ç»„ `[1,2]` çš„å’Œä¸º3ï¼Œcount+=1ï¼Œæ›´æ–° map ä¸º `{0:1,1:1,3:1}`ã€‚
4. éå†åˆ° `i=2`ï¼Œsum=6ï¼Œmapé‡Œæœ‰ `6-3=3`ï¼Œè¯´æ˜æœ‰ä¸€ä¸ªå­æ•°ç»„ `[3]` çš„å’Œä¸º3ï¼Œcount+=1ï¼Œæ›´æ–° map ä¸º `{0:1,1:1,3:1,6:1}`ã€‚

æœ€ç»ˆç»“æœ `count=2`ï¼Œä¸å‰é¢åˆ†æä¸€è‡´ã€‚

---


## å…¬å¼æ¨å¯¼

å‰ç¼€å’Œ + å“ˆå¸Œè¡¨çš„æ ¸å¿ƒå…¬å¼æ˜¯ï¼š

$$
prefix[j] - prefix[i] = k \implies prefix[i] = prefix[j] - k
$$

ä¹Ÿå°±æ˜¯è¯´ï¼š

```java
int target = prefix - k;
```

ç„¶åæ£€æŸ¥ `map.containsKey(target)`ï¼Œå¦‚æœå­˜åœ¨ï¼Œè¯´æ˜æœ‰å­æ•°ç»„å’Œä¸º kã€‚

æ›´æ–° map æ—¶ **ä¸åº”è¯¥æ”¾åœ¨ else**ï¼Œæ¯æ¬¡éƒ½è¦æ›´æ–°å½“å‰å‰ç¼€å’Œçš„æ¬¡æ•°ã€‚

---

## javaè§£æ³•

```java
class Solution {
    public int subarraySum(int[] nums, int k) {
        // prefix[j] - prefix[i] = k
        // prefix[i] = prefix[j] - k
        Map<Integer, Integer> map = new HashMap<>();
        map.put(0, 1);
        int prefix = 0;
        int res = 0;
        for (int i = 0; i < nums.length; i++) {
            prefix += nums[i];
            int target = prefix - k;
            if (map.containsKey(target)) {
                res += map.get(target);
            }
            map.put(prefix, map.getOrDefault(prefix, 0) + 1);
        }
        return res;
    }
}

```


# leetcode 974

## é¢˜ç›®å›é¡¾

ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ•´æ•° k ï¼Œè¿”å›å…¶ä¸­å…ƒç´ ä¹‹å’Œå¯è¢« k æ•´é™¤çš„éç©º å­æ•°ç»„ çš„æ•°ç›®ã€‚

## å…¬å¼æ¨å¯¼ ç±»ä¼¼ Leetcode 523

è¦æ‰¾åˆ°å…¶ä¸­å­æ•°ç»„çš„å’Œ èƒ½è¢«kæ•´é™¤
(sum[j] - sum[i]) % k == 0
åˆ™ =>
sum[j] % k == sum[i] % k
=>
æ‰¾åˆ°ç›¸åŒçš„ä½™æ•°å³å¯

## æ³¨æ„
`-104 <= nums[i] <= 104`

å…¶ä¸­å­æ•°ç»„å’Œä¸ºå¯èƒ½ä¸ºè´Ÿæ•°

å¥½é—®é¢˜ ğŸ‘
è¿™ä¸ªå…¬å¼ **`(mod + k) % k`** çš„æœ¬è´¨æ˜¯ï¼šæŠŠå¯èƒ½ä¸ºè´Ÿæ•°çš„ä½™æ•°â€œæ¬å›â€åˆ° `[0, k-1]` åŒºé—´ã€‚

---

### 1ï¸âƒ£ Java `%` è¿ç®—çš„é—®é¢˜

åœ¨ Java é‡Œï¼š

```java
-1 % 5 == -1   // ç»“æœå’Œè¢«é™¤æ•°ç¬¦å·ä¸€è‡´
```

ä½†åœ¨æ•°å­¦é‡Œï¼Œæˆ‘ä»¬å¸Œæœ›å–ä½™ç»“æœæ°¸è¿œæ˜¯ **éè´Ÿæ•°**ï¼Œè½åœ¨ `[0, k-1]`ã€‚
æ¯”å¦‚ï¼š

```
-1 â‰¡ 4 (mod 5)
```

æ•°å­¦ä¸Šè¯´ `-1` å’Œ `4` åœ¨åŒä¸€ä¸ªä½™æ•°ç±»é‡Œã€‚

---

### 2ï¸âƒ£ ä¸ºä»€ä¹ˆ `(mod + k) % k` å¯ä»¥ä¿®æ­£ï¼Ÿ

å‡è®¾ï¼š

```java
mod = prefix % k
```

å¯èƒ½æ˜¯è´Ÿæ•°ã€‚

æˆ‘ä»¬æƒ³è¦æŠŠå®ƒè½¬æ¢æˆ **ç­‰ä»·çš„æ­£ä½™æ•°**ã€‚

* å¦‚æœ `mod >= 0`ï¼š

  ```
  (mod + k) % k = mod
  ```

  æ²¡å˜åŒ–ã€‚

* å¦‚æœ `mod < 0`ï¼š

  ```
  mod + k   â†’ æŠŠå®ƒâ€œæŠ¬é«˜â€åˆ° >= 0
  (mod + k) % k   â†’ ä¿è¯æœ€åç»“æœä»ç„¶è½åœ¨ [0, k-1]
  ```

ä¸¾ä¾‹ï¼š

```java
prefix = -1, k = 5
mod = -1 % 5 = -1

(mod + k) % k = (-1 + 5) % 5 = 4   âœ…
```

è¿™å°±æŠŠ `-1` ä¿®æ­£æˆäº†æ­£ç¡®çš„æ•°å­¦ä½™æ•° `4`ã€‚

---

### 3ï¸âƒ£ æ€»ç»“æˆå…¬å¼

æˆ‘ä»¬è¦çš„ä¸æ˜¯ Java `%` çš„ç»“æœï¼Œè€Œæ˜¯**æ•°å­¦å®šä¹‰çš„ä½™æ•°**ï¼š

```
r = a - âŒŠa/kâŒ‹ * k   (ä¿è¯ 0 â‰¤ r < k)
```

åœ¨ä»£ç é‡Œæœ€ç®€å•çš„å†™æ³•å°±æ˜¯ï¼š

```java
int mod = ((prefix % k) + k) % k;
```

---

## javaè§£æ³•

```JAVA
class Solution {
    public int subarraysDivByK(int[] nums, int k) {
        // (sum[j] - sum[i]) % k == 0;
        // sum[j] % k == sum[i] % k
        // key = mod | value = å½“å‰è¿™ä¸ªä½™æ•°=modçš„ä¸ªæ•°
        Map<Integer, Integer> map = new HashMap<>();
        map.put(0, 1);
        int prefix = 0;
        int res = 0;
        for (int i = 0; i < nums.length; i++) {
            prefix += nums[i];
            int mod = ((prefix % k) + k) % k;
            if (map.containsKey(mod)) {
                res += map.get(mod);
            }
            map.put(mod, map.getOrDefault(mod, 0) + 1);
        }
        return res;
    }
}
```

# leetcode 1124

---

## é¢˜ç›®å›é¡¾

* è¾“å…¥ï¼šä¸€ä¸ªæ•°ç»„ `hours`ï¼Œå…¶ä¸­ `hours[i]` è¡¨ç¤ºç¬¬ i å¤©çš„å·¥ä½œæ—¶é•¿ã€‚
* å®šä¹‰ï¼šå¦‚æœæŸä¸€å¤©å·¥ä½œæ—¶é•¿ > 8 å°æ—¶ï¼Œåˆ™ç®—ä½œã€Œç–²åŠ³çš„ä¸€å¤©ã€ã€‚
* ç›®æ ‡ï¼šæ‰¾å‡ºä¸€ä¸ªæœ€é•¿çš„è¿ç»­æ—¶é—´æ®µï¼Œä½¿å¾—å…¶ä¸­ã€Œç–²åŠ³å¤©æ•°ã€ä¸¥æ ¼å¤šäºã€Œéç–²åŠ³å¤©æ•°ã€ã€‚

---

## æ€è·¯åˆ†æ

### 1. è½¬æ¢é—®é¢˜

æˆ‘ä»¬æŠŠ `hours` è½¬æ¢æˆ `+1` å’Œ `-1`ï¼š

* `hours[i] > 8` â†’ `+1`
* `hours[i] â‰¤ 8` â†’ `-1`

è¿™æ ·é—®é¢˜å°±å˜æˆï¼š
**æ‰¾æœ€é•¿çš„è¿ç»­å­æ•°ç»„ï¼Œä½¿å¾—å­æ•°ç»„çš„å’Œ > 0ã€‚**

---

### 2. å‰ç¼€å’Œå»ºæ¨¡

å®šä¹‰å‰ç¼€å’Œæ•°ç»„ `prefix`ï¼š

* `prefix[0] = 0`
* `prefix[i] = arr[0] + arr[1] + ... + arr[i-1]`

é—®é¢˜è½¬åŒ–ä¸ºï¼š

* æ‰¾æœ€å¤§åŒºé—´ `(i, j)`ï¼Œä½¿å¾— `prefix[j] - prefix[i] > 0`ï¼Œå³ `prefix[j] > prefix[i]`ã€‚

---


## O(nÂ²)è§£æ³•

```JAVA
class Solution {
    public int longestWPI(int[] hours) {
        // [9,9,6,0,6,6,9]
        // [1,1,-1,-1,-1,-1,1]
        // [0,1,2,1,0,-1,-2,-1]
        int [] prefix = new int[hours.length + 1];
        for (int i = 0; i < hours.length; i++) {
            int num = hours[i] > 8 ? 1 : -1;
            prefix[i + 1] = prefix[i] + num;
        }
        int ans = 0;
        for (int i = 0; i < prefix.length; i++) {
            for (int j = i + 1; j < prefix.length; j++) {
                int k = prefix[j] - prefix[i];
                if (k > 0) {
                    ans = Math.max(j - i, ans);
                }
            }
        }
        return ans;
    }
}
```

## ä¼˜åŒ–åŒé‡å¾ªç¯

**â€œä¸ºä»€ä¹ˆåªè¦æ‰¾åˆ°æœ€å·¦è¾¹çš„å°å‰ç¼€ï¼Œå°±èƒ½å¾—åˆ°æœ€é•¿åŒºé—´â€**

---

### ç›®æ ‡

è¦æ‰¾æœ€é•¿çš„åŒºé—´ `(i, j)`ï¼Œæ»¡è¶³ï¼š

```
prefix[j] > prefix[i]  ä¸”  j > i
```

åŒºé—´é•¿åº¦å°±æ˜¯ `j - i`ã€‚

æ‰€ä»¥å¯¹äºæ¯ä¸ª `j`ï¼Œæˆ‘ä»¬æƒ³è¦ï¼š

* æ‰¾åˆ° **ä¸€ä¸ªæœ€å°çš„ iï¼ˆè¶Šå·¦è¶Šå¥½ï¼‰**ï¼ŒåŒæ—¶æ»¡è¶³ `prefix[i] < prefix[j]`ã€‚

è¿™æ ·ä¸€æ¥ï¼ŒåŒºé—´é•¿åº¦ `j - i` å°±æœ€å¤§ã€‚

---

### ä¸ºä»€ä¹ˆæ˜¯â€œæœ€å·¦è¾¹çš„å°å‰ç¼€â€

å‡è®¾ä½ æœ‰ä¸¤ä¸ªå‰ç¼€ï¼š

```
i1 < i2
prefix[i1] < prefix[i2] < prefix[j]
```

é‚£ä¹ˆï¼š

* åŒºé—´ (i1, j) é•¿åº¦ = j - i1
* åŒºé—´ (i2, j) é•¿åº¦ = j - i2

æ˜¾ç„¶ **i1 æ›´é å·¦ï¼Œå¾—åˆ°çš„åŒºé—´æ›´é•¿**ã€‚
æ‰€ä»¥å¯¹äºæ¯ä¸ª jï¼Œæˆ‘ä»¬åªéœ€è¦æœ€å·¦è¾¹é‚£ä¸ªæ¯” prefix\[j] å°çš„å‰ç¼€ã€‚

---

### å•è°ƒæ ˆä¿è¯â€œæœ€å·¦è¾¹çš„å°å‰ç¼€â€

å½“æˆ‘ä»¬ä»å·¦å¾€å³æ„å»ºæ ˆæ—¶ï¼š

* åªæŠŠ **æ›´å°çš„ prefix å€¼** å…¥æ ˆï¼›
* å¦‚æœ prefix å˜å¤§ï¼Œå°±ä¸å…¥æ ˆï¼ˆå› ä¸ºå®ƒä¸ä¼šæ˜¯ä»»ä½• j çš„æœ€ä¼˜å·¦ç«¯ç‚¹ï¼‰ã€‚

è¿™æ ·æ ˆé‡Œå­˜çš„ä¸‹æ ‡ i æ˜¯ **ä¸¥æ ¼é€’å‡çš„ prefix\[i]**ï¼Œè€Œä¸”è¶Šé æ ˆåº•ï¼Œi è¶Šé å·¦ã€‚
æ‰€ä»¥å½“æˆ‘ä»¬ä»å³å¾€å·¦æ‰«æ j æ—¶ï¼š

* ç¬¬ä¸€ä¸ªè¢«æ»¡è¶³ `prefix[j] > prefix[i]` çš„ i ä¸€å®šæ˜¯æœ€å·¦çš„å€™é€‰ï¼›
* å› æ­¤ j - i æœ€å¤§ã€‚


## ä¸ºä»€ä¹ˆè¦ä»å³å¾€å·¦æ£€æŸ¥

æˆ‘ä»¬è¦æ‰¾ï¼š

```
æœ€å¤§åŒ– j - i
æ»¡è¶³ prefix[j] > prefix[i]
```

æ˜¾ç„¶ï¼š

* å¦‚æœ j è¶Šå¤§ï¼ŒåŒºé—´é•¿åº¦ j - i è¶Šå¯èƒ½å¤§ã€‚
* æ‰€ä»¥æˆ‘ä»¬æƒ³ä¼˜å…ˆæ£€æŸ¥â€œå³è¾¹çš„ jâ€ï¼Œè¿™æ ·ä¸€æ—¦æ‰¾åˆ°åˆæ³•åŒºé—´ï¼Œé•¿åº¦å°±å·²ç»æ˜¯å°½å¯èƒ½å¤§çš„äº†ã€‚

---

### å•è°ƒæ ˆçš„ç»“æ„

å›å¿†å•è°ƒæ ˆæ„å»ºè¿‡ç¨‹ï¼š

* ä»å·¦å¾€å³æ‰«æ prefixï¼Œæ ˆä¸­ä¿ç•™ **ä¸¥æ ¼é€’å‡çš„ prefix å€¼å¯¹åº”çš„ä¸‹æ ‡**ã€‚
* è¿™äº›ä¸‹æ ‡æ˜¯ã€Œæ½œåœ¨çš„æœ€ä¼˜ iã€ã€‚

å½“æˆ‘ä»¬åœ¨å³è¾¹æ‹¿ä¸€ä¸ª j æ¥æ£€æŸ¥æ—¶ï¼š

* å¦‚æœ `prefix[j] > prefix[stack.peek()]`ï¼Œå°±èƒ½å½¢æˆåŒºé—´ï¼›
* è€Œä¸”å› ä¸º **j æ˜¯å°½é‡é å³çš„**ï¼Œæ‰€ä»¥ `j - i` å·²ç»å¾ˆå¤§äº†ï¼›
* æˆ‘ä»¬å¯ä»¥ä¸æ–­å¼¹æ ˆï¼Œæ‹¿åˆ°æ›´å·¦è¾¹çš„ iï¼Œå½¢æˆæ›´é•¿çš„åŒºé—´ã€‚

---

### å¦‚æœä»å·¦å¾€å³ä¼šæ€æ ·ï¼Ÿ

å‡è®¾æˆ‘ä»¬ä»å·¦å¾€å³æ‰«æ jï¼š

* å½“é‡åˆ°ä¸€ä¸ª prefix\[j] æ—¶ï¼Œä½ åªèƒ½å’Œæ ˆé‡Œå½“å‰çš„ i é…å¯¹ï¼›
* ä½†æ­¤æ—¶ j å¯èƒ½è¿˜æ¯”è¾ƒé å·¦ï¼Œå¾—åˆ°çš„åŒºé—´é•¿åº¦å¹¶ä¸æ˜¯æœ€å¤§ï¼›
* åé¢å‡ºç°æ›´å³è¾¹çš„ j æ—¶ï¼Œä½ éœ€è¦é‡æ–°è€ƒè™‘ä¹‹å‰çš„ iï¼Œä½†æ ˆçš„çŠ¶æ€å·²ç»æ”¹å˜äº†ï¼Œå®¹æ˜“æ¼æ‰ç­”æ¡ˆã€‚

æ‰€ä»¥ä»å·¦å¾€å³ä¸å¥½ä¿è¯â€œæœ€é•¿â€ã€‚

---

## ä¼˜åŒ–å•è°ƒæ ˆè§£æ³•

```java
class Solution {
    public int longestWPI(int[] hours) {
        int n = hours.length;
        int [] prefix = new int[n + 1];
        for (int i = 1; i <= n; i++) {
            int num = hours[i - 1] > 8 ? 1 : -1;
            prefix[i] = prefix[i - 1] + num;
        }

        // prefix[j] - prefix[i] > 0
        // prefix[j] > prefix[i] && j < i
        // i è¶Šå°åˆ™åŒºé—´è¶Šå¤§
        Deque<Integer> deque = new ArrayDeque<>();
        for (int i = 0; i <= n; i++) {
            if (deque.isEmpty() || prefix[i] < prefix[deque.peek()]) {
                deque.push(i);
            }
        }

        int ans = 0;
        for (int j = n; j >= 0; j--) {
            while (!deque.isEmpty() && prefix[j] > prefix[deque.peek()]) {
                ans = Math.max(ans, j - deque.pop());
            }
        }
        return ans;
    }
}
```